# Resync Router and Utility Prompts
# Used for intent classification, formatting, and system operations

# =============================================================================
# ROUTER PROMPTS (Intent Classification)
# =============================================================================

- id: intent-router-v1
  name: Intent Router Prompt
  type: router
  version: "1.0.0"
  description: "Classifies user intent for routing to appropriate handler"
  
  content: |
    Classifique a inten√ß√£o do usu√°rio em UMA das seguintes categorias:
    
    - STATUS: Consultas sobre status de jobs, workstations, ou sistema
      Exemplos: "qual o status do job X", "workstations online", "sistema est√° ok?"
    
    - TROUBLESHOOT: Diagn√≥stico de problemas, erros, falhas
      Exemplos: "job X deu ABEND", "por que o job falhou", "erro no TWS"
    
    - QUERY: Perguntas sobre documenta√ß√£o, conceitos, procedimentos
      Exemplos: "como criar um job", "o que √© job stream", "documenta√ß√£o sobre..."
    
    - ACTION: Solicita√ß√µes para executar a√ß√µes no sistema
      Exemplos: "cancelar job X", "reiniciar job", "submeter job Y"
    
    - GENERAL: Conversas gerais, sauda√ß√µes, ajuda
      Exemplos: "ol√°", "ajuda", "o que voc√™ pode fazer"
    
    Mensagem do usu√°rio: "{{user_message}}"
    
    Responda APENAS com o nome da categoria em mai√∫sculas (STATUS, TROUBLESHOOT, QUERY, ACTION ou GENERAL).
  
  variables:
    - user_message
  model_hint: "meta/llama-3.1-8b-instruct"
  temperature_hint: 0.1
  max_tokens_hint: 10
  is_active: true
  is_default: false


# NEW v5.9.1: Enhanced router with entity extraction
- id: intent-router-v2
  name: Intent Router with Entity Extraction
  type: router
  version: "2.0.0"
  description: "Classifies user intent AND extracts entities (job names, workstations, etc.)"
  
  content: |
    Analise a mensagem do usu√°rio e extraia:
    1. A inten√ß√£o (intent)
    2. As entidades mencionadas (entities)
    
    ## Categorias de Inten√ß√£o
    - STATUS: Consultas sobre status de jobs, workstations, ou sistema
    - TROUBLESHOOT: Diagn√≥stico de problemas, erros, falhas
    - QUERY: Perguntas sobre documenta√ß√£o, conceitos, procedimentos
    - ACTION: Solicita√ß√µes para executar a√ß√µes no sistema
    - GENERAL: Conversas gerais, sauda√ß√µes, ajuda
    
    ## Entidades a Extrair
    - job_name: Nome do job mencionado (geralmente em MAI√öSCULAS com underscores)
    - workstation: Nome da workstation mencionada
    - action_type: Tipo de a√ß√£o solicitada (cancelar, reiniciar, executar, etc.)
    - error_code: C√≥digo de erro mencionado (ex: AWSB1234E, RC=12)
    
    ## Mensagem do Usu√°rio
    "{{user_message}}"
    
    ## Resposta (JSON)
    Responda APENAS com um objeto JSON no formato:
    {"intent": "INTENT_NAME", "entities": {"entity_name": "value"}, "confidence": 0.85}
    
    Se n√£o encontrar entidades, retorne entities como objeto vazio {}.
  
  variables:
    - user_message
  model_hint: "meta/llama-3.1-8b-instruct"
  temperature_hint: 0.1
  max_tokens_hint: 100
  is_active: true
  is_default: true


# =============================================================================
# TOOL PROMPTS (Formatting)
# =============================================================================

- id: tool-response-formatter-v1
  name: Tool Response Formatter
  type: tool
  version: "1.0.0"
  description: "Formats tool outputs into user-friendly responses"
  
  content: |
    Formate a resposta da ferramenta de forma clara e leg√≠vel para o usu√°rio.
    
    ## Ferramenta Executada
    {{tool_name}}
    
    ## Resultado Bruto
    {{tool_output}}
    
    ## Instru√ß√µes de Formata√ß√£o
    - Apresente as informa√ß√µes de forma organizada
    - Use negrito para destacar valores importantes
    - Se houver erros, explique o que pode ter acontecido
    - Se houver muitos itens, agrupe ou resuma
    - Mantenha o tom profissional
  
  variables:
    - tool_name
    - tool_output
  default_values:
    tool_name: "ferramenta desconhecida"
    tool_output: "{}"
  model_hint: "meta/llama-3.1-70b-instruct"
  temperature_hint: 0.5
  max_tokens_hint: 800
  is_active: true
  is_default: true


- id: status-report-formatter-v1
  name: Status Report Formatter
  type: tool
  version: "1.0.0"
  description: "Formats TWS status data into a readable report"
  
  content: |
    Gere um relat√≥rio de status do sistema TWS baseado nos dados fornecidos.
    
    ## Dados do Sistema
    {{system_data}}
    
    ## Formato do Relat√≥rio
    
    ### üìä Resumo Executivo
    [2-3 linhas com vis√£o geral do estado do sistema]
    
    ### üñ•Ô∏è Workstations
    [Status de cada workstation: ONLINE/OFFLINE]
    
    ### ‚ö†Ô∏è Jobs Cr√≠ticos/Problem√°ticos
    [Lista de jobs em ABEND, STUCK ou que requerem aten√ß√£o]
    
    ### üí° Recomenda√ß√µes
    [A√ß√µes sugeridas se houver problemas]
    
    Seja conciso e priorize informa√ß√µes cr√≠ticas.
  
  variables:
    - system_data
  default_values:
    system_data: "{}"
  model_hint: "meta/llama-3.1-70b-instruct"
  temperature_hint: 0.4
  max_tokens_hint: 1000
  is_active: true
  is_default: true


# =============================================================================
# SYSTEM PROMPTS
# =============================================================================

- id: error-explainer-v1
  name: Error Explainer Prompt
  type: system
  version: "1.0.0"
  description: "Explains TWS error codes and messages"
  
  content: |
    Voc√™ √© um especialista em erros do HCL Workload Automation (TWS).
    
    Analise o erro abaixo e forne√ßa:
    1. **O que significa**: Explica√ß√£o clara do erro
    2. **Causas comuns**: Por que isso geralmente acontece
    3. **Como resolver**: Passos para corrigir o problema
    4. **Preven√ß√£o**: Como evitar no futuro
    
    ## Informa√ß√µes do Erro
    - C√≥digo: {{error_code}}
    - Mensagem: {{error_message}}
    - Job: {{job_name}}
    - Contexto adicional: {{context}}
    
    Responda de forma t√©cnica mas acess√≠vel.
  
  variables:
    - error_code
    - error_message
    - job_name
    - context
  default_values:
    error_code: "N/A"
    error_message: "Erro desconhecido"
    job_name: "N/A"
    context: "Nenhum contexto adicional"
  model_hint: "meta/llama-3.1-70b-instruct"
  temperature_hint: 0.4
  max_tokens_hint: 800
  is_active: true
  is_default: true
